@startuml
set separator none

package "Persistence " #DDDDDD {
    class PersistenceContext {
        + getRepositoryFactory(): RepositoryFactory
    }
}

package "persistence.impl.jpa" #DDDDDD {
    class JpaRepositoryFactory {
        - JpaRepositoryFactory()
        + getInstance(): RepositoryFactory
    }

    class JpaCategoryRepository {
    }

}

package "persistence.impl.inmemory" #DDDDDD {
    class InMemoryRepositoryFactory {
        - InMemoryRepositoryFactory()
        + getInstance(): RepositoryFactory
    }

    class InMemoryCategoryRepository {
    }
}

package "Domain" #DDDDDD {


    package "Repository " #DDDDDD {
        interface RepositoryFactory {
            + getCategoryRepository(): CategoryRepository
        }

        interface CategoryRepository {
            + addFigureCategory(category)
        }

    }

    'Category Aggregate
    class Category <<Entity>>{
        + Category (name, description)
    }

    enum CategoryStatus <<Value Object>>{
    }

    class CategoryName <<Value Object>>{
    }

    class CategoryDescription <<Value Object>>{
    }
}

package "UI" #DDDDDD {
    class AddFigureCategoryUI <<UI>> {
        + addFigureCategory(category)
    }
}

package "Controller" #DDDDDD {
    class AddFigureCategoryController <<Controller>> {
        + addFigureCategory(category)
    }
}

'Persistence

    'PersistenceContext -> x
    PersistenceContext ..> RepositoryFactory: categoryRepository()
    PersistenceContext ..> JpaRepositoryFactory
    PersistenceContext ..> InMemoryRepositoryFactory

'persistence.impl.jpa

    'JpaCategoryRepository -> x
    JpaCategoryRepository --|> CategoryRepository

    'JpaRepositoryFactory -> x
    JpaRepositoryFactory ..|> RepositoryFactory
    JpaRepositoryFactory ..> JpaCategoryRepository
    JpaRepositoryFactory --> JpaRepositoryFactory: instance

'persistence.impl.inmemory

    'InMemoryFigureRepository -> x
    InMemoryCategoryRepository ..|> CategoryRepository

    'InMemoryRepositoryFactory -> x
    InMemoryRepositoryFactory ..|> RepositoryFactory
    InMemoryRepositoryFactory ..> InMemoryCategoryRepository
    InMemoryRepositoryFactory --> InMemoryRepositoryFactory: instance

'Repository

    'CategoryRepository -> x
    CategoryRepository ...> Category

    'RepositoryFactory -> x
    RepositoryFactory ..> CategoryRepository

'Domain

    'Category -> x
    Category --> "1" CategoryStatus: categoryStatus
    Category --> "1" CategoryName: name
    Category --> "1" CategoryDescription: description

'UI

    'ListPublicCatalogueUI -> x
    AddFigureCategoryUI ..> AddFigureCategoryController

'Controller

    'ListPublicCatalogueController -> x
    AddFigureCategoryController ..> PersistenceContext : getRepositoryFactory()
    AddFigureCategoryController ..> RepositoryFactory : getCategoryRepository()
    AddFigureCategoryController ..> CategoryRepository : addFigureCategory(category)


@enduml