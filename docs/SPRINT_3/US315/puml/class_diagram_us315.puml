@startuml
set separator none
left to right direction


package "Domain" #DDDDDD {

    package "Repository " #DDDDDD {
        Interface ShowProposalRepository <<Repository>> {
            + findAllTestingProposals() : Iterable<ShowProposal>

        }

        Interface RepositoryFactory <<Factory>> {
            - RepositoryFactory()
            + proposals() : ShowProposalRepository
        }

    }

        class ShowProposal <<Entity>> <<root>>{
        }

        class Video <<Value Object>>{
        }

        class VideoList {
        }
}

package "UI" #DDDDDD {
    class AddVideoToProposalUI <<UI>> {

    }
}

package "Controller" #DDDDDD {
    class AddVideoToProposalController <<Controller>> {
        + findAllTestingProposals() : Iterable<ShowProposal>
        + listVideos()
    }
}

package "persistence.impl.jpa" #DDDDDD {
    class JpaShowProposalRepository <<Repository>> {
        + findAllTestingProposals() : Iterable<ShowProposal>
    }

    class JpaRepositoryFactory <<Factory>> {
        - JpaRepositoryFactory()
        + proposals() : ShowProposalRepository
    }

}

package "persistence.impl.inmemory" #DDDDDD {
    class InMemoryShowProposalRepository <<Repository>> {
        + findAllTestingProposals() : Iterable<ShowProposal>
    }

    class InMemoryRepositoryFactory <<Factory>> {
        - InMemoryRepositoryFactory()
        + proposals() : ShowProposalRepository
    }
}

package "persistence" #DDDDDD {
    class PersistenceContext {
        repositories() : RepositoryFactory
    }
}

' Relações entre as classes

ShowProposal --> "1" Video: video

RepositoryFactory ..> ShowProposalRepository : proposals()

ShowProposalRepository --> "0..*" ShowProposal : proposals

AddVideoToProposalUI ..> AddVideoToProposalController
AddVideoToProposalController ..> RepositoryFactory : proposals()
AddVideoToProposalController ..> ShowProposalRepository : proposals()
AddVideoToProposalController ..> PersistenceContext : repositories()

AddVideoToProposalController ..> VideoList : listVideos()

PersistenceContext ..> JpaRepositoryFactory : JpaRepositoryFactory()
PersistenceContext ..> InMemoryRepositoryFactory : InMemoryRepositoryFactory()
PersistenceContext ..> RepositoryFactory : proposals()

JpaRepositoryFactory ...|> RepositoryFactory : proposals()
JpaRepositoryFactory ..> JpaShowProposalRepository

JpaShowProposalRepository ..|> ShowProposalRepository : findAllTestingProposals()


InMemoryRepositoryFactory .|> RepositoryFactory : proposals()
InMemoryRepositoryFactory ..> InMemoryShowProposalRepository

InMemoryShowProposalRepository ..|> ShowProposalRepository : findAllTestingProposals()


@enduml